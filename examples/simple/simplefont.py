import sys
import struct

# Add the library directories to the module search path.
sys.path.append('../..')
sys.path.append('../../bteve2')

font0_offset = 1000 # Taken from commmand line
global font_width_in_pixels

font0 = bytes([
    # 10 characters have been converted

    # 148 Metric Block Begin +++ 
    #('file properties ', 'format ', 'L1', ' stride ', 5, ' width ', 36, 'height', 'address', 1000)
    
    # Widths 
    0,36,20,36,36,36,36,36,36,36,36,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    # Format 
    1,0,0,0,
    # Stride 
    5,0,0,0,
    # Max Width
    36,0,0,0,
    # Max Height 
    58,0,0,0,
    # Raw Data Address in Decimal: <858> 
    90,3,0,0,

    # 148 Metric Block End --- 

    # Bitmap Raw Data begin +++
    # The expected raw bitmap size is 2900 Bytes 
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,127,255,255,192,0,63,255,255,128,1,31,255,255,16,1,143,255,254,32,1,199,255,252,96,1,227,255,248,224,1,
    243,255,241,224,1,248,0,3,224,1,248,0,7,224,1,248,0,15,224,1,248,0,15,224,1,248,0,15,224,1,248,0,
    15,224,3,248,0,15,224,3,248,0,15,224,3,248,0,15,192,3,248,0,15,192,3,240,0,15,192,3,224,0,7,192,
    3,192,0,3,192,1,128,0,1,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,3,128,
    0,3,128,7,192,0,7,128,7,224,0,31,128,7,240,0,31,128,7,240,0,31,128,7,240,0,31,128,7,224,0,63,
    128,7,224,0,63,128,7,224,0,63,128,7,224,0,63,128,15,224,0,63,128,15,224,0,63,128,15,192,0,31,128,15,
    143,255,143,0,15,31,255,199,0,14,63,255,231,0,12,127,255,243,0,8,255,255,249,0,1,255,255,248,0,7,255,255,
    252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,128,0,0,0,1,128,0,0,0,3,128,0,0,0,7,128,0,0,0,7,128,0,
    0,0,15,128,0,0,0,31,128,0,0,0,63,0,0,0,0,63,0,0,0,0,63,0,0,0,0,63,0,0,0,0,
    127,0,0,0,0,127,0,0,0,0,127,0,0,0,0,127,0,0,0,0,127,0,0,0,0,127,0,0,0,0,63,0,
    0,0,0,30,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,
    0,28,0,0,0,0,62,0,0,0,0,126,0,0,0,0,254,0,0,0,0,254,0,0,0,0,254,0,0,0,0,252,
    0,0,0,0,252,0,0,0,0,252,0,0,0,0,252,0,0,0,0,252,0,0,0,1,252,0,0,0,0,252,0,0,
    0,0,124,0,0,0,0,124,0,0,0,0,60,0,0,0,0,28,0,0,0,0,12,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,127,255,255,192,0,63,255,255,128,0,31,255,255,16,0,15,255,254,32,0,7,255,252,96,0,3,
    255,248,224,0,3,255,241,224,0,0,0,3,224,0,0,0,7,224,0,0,0,15,224,0,0,0,15,224,0,0,0,15,
    224,0,0,0,15,224,0,0,0,15,224,0,0,0,15,224,0,0,0,15,192,0,0,0,15,192,0,0,0,15,192,0,
    0,0,7,192,0,15,255,243,192,0,31,255,241,128,0,63,255,248,0,0,63,255,252,0,0,63,255,248,0,1,31,255,
    240,0,3,143,255,224,0,7,192,0,0,0,7,224,0,0,0,7,240,0,0,0,7,240,0,0,0,7,240,0,0,0,
    7,224,0,0,0,7,224,0,0,0,7,224,0,0,0,7,224,0,0,0,15,224,0,0,0,15,224,0,0,0,15,192,
    0,0,0,15,143,255,128,0,15,31,255,192,0,14,63,255,224,0,12,127,255,240,0,8,255,255,248,0,1,255,255,248,
    0,7,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,127,255,255,192,0,63,255,255,128,0,31,255,255,16,0,15,255,254,32,0,7,255,252,96,
    0,3,255,248,224,0,3,255,241,224,0,0,0,3,224,0,0,0,7,224,0,0,0,15,224,0,0,0,15,224,0,0,
    0,15,224,0,0,0,15,224,0,0,0,15,224,0,0,0,15,224,0,0,0,15,192,0,0,0,15,192,0,0,0,15,
    192,0,0,0,7,192,0,15,255,243,192,0,31,255,241,128,0,63,255,248,0,0,63,255,252,0,0,63,255,248,0,0,
    31,255,241,0,0,15,255,227,128,0,0,0,7,128,0,0,0,31,128,0,0,0,31,128,0,0,0,31,128,0,0,0,
    31,128,0,0,0,63,128,0,0,0,63,128,0,0,0,63,128,0,0,0,63,128,0,0,0,63,128,0,0,0,63,128,
    0,0,0,31,128,0,15,255,143,0,0,31,255,207,0,0,63,255,231,0,0,127,255,243,0,0,255,255,249,0,1,255,
    255,248,0,7,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,128,0,0,32,1,192,0,0,96,1,192,0,
    0,224,1,224,0,1,224,1,240,0,3,224,1,248,0,7,224,1,248,0,15,224,1,248,0,15,224,1,248,0,15,224,
    1,248,0,15,224,1,248,0,15,224,3,248,0,15,224,3,248,0,15,224,3,248,0,15,192,3,248,0,15,192,3,240,
    0,15,192,3,224,0,7,192,3,207,255,243,192,1,159,255,241,128,0,63,255,248,0,0,63,255,252,0,0,63,255,248,
    0,0,31,255,241,0,0,15,255,227,128,0,0,0,7,128,0,0,0,31,128,0,0,0,31,128,0,0,0,31,128,0,
    0,0,31,128,0,0,0,63,128,0,0,0,63,128,0,0,0,63,128,0,0,0,63,128,0,0,0,63,128,0,0,0,
    63,128,0,0,0,63,128,0,0,0,31,0,0,0,0,15,0,0,0,0,7,0,0,0,0,3,0,0,0,0,1,0,
    0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,192,0,63,255,255,128,1,31,255,255,0,1,143,255,254,0,1,
    199,255,252,0,1,227,255,248,0,1,243,255,240,0,1,248,0,0,0,1,248,0,0,0,1,248,0,0,0,1,248,0,
    0,0,1,248,0,0,0,1,248,0,0,0,3,248,0,0,0,3,248,0,0,0,3,248,0,0,0,3,248,0,0,0,
    3,240,0,0,0,3,224,0,0,0,3,207,255,240,0,1,159,255,240,0,0,63,255,248,0,0,63,255,252,0,0,63,
    255,248,0,0,31,255,241,0,0,15,255,227,128,0,0,0,7,128,0,0,0,31,128,0,0,0,31,128,0,0,0,31,
    128,0,0,0,31,128,0,0,0,63,128,0,0,0,63,128,0,0,0,63,128,0,0,0,63,128,0,0,0,63,128,0,
    0,0,63,128,0,0,0,31,128,0,15,255,143,0,0,31,255,207,0,0,63,255,231,0,0,127,255,243,0,0,255,255,
    249,0,1,255,255,248,0,7,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,192,0,63,255,255,128,1,31,255,255,0,1,143,255,254,
    0,1,199,255,252,0,1,227,255,248,0,1,243,255,240,0,1,248,0,0,0,1,248,0,0,0,1,248,0,0,0,1,
    248,0,0,0,1,248,0,0,0,1,248,0,0,0,3,248,0,0,0,3,248,0,0,0,3,248,0,0,0,3,248,0,
    0,0,3,240,0,0,0,3,224,0,0,0,3,207,255,240,0,1,159,255,240,0,0,63,255,248,0,0,63,255,252,0,
    0,63,255,248,0,1,31,255,241,0,3,143,255,227,128,7,192,0,7,128,7,224,0,31,128,7,240,0,31,128,7,240,
    0,31,128,7,240,0,31,128,7,224,0,63,128,7,224,0,63,128,7,224,0,63,128,7,224,0,63,128,15,224,0,63,
    128,15,224,0,63,128,15,192,0,31,128,15,143,255,143,0,15,31,255,199,0,14,63,255,231,0,12,127,255,243,0,8,
    255,255,249,0,1,255,255,248,0,7,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,192,0,63,255,255,128,0,31,255,255,16,0,15,
    255,254,32,0,7,255,252,96,0,3,255,248,224,0,3,255,241,224,0,0,0,3,224,0,0,0,7,224,0,0,0,15,
    224,0,0,0,15,224,0,0,0,15,224,0,0,0,15,224,0,0,0,15,224,0,0,0,15,224,0,0,0,15,192,0,
    0,0,15,192,0,0,0,15,192,0,0,0,7,192,0,0,0,3,192,0,0,0,1,128,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,3,128,0,0,0,7,128,0,0,0,31,128,0,0,0,31,128,
    0,0,0,31,128,0,0,0,31,128,0,0,0,63,128,0,0,0,63,128,0,0,0,63,128,0,0,0,63,128,0,0,
    0,63,128,0,0,0,63,128,0,0,0,63,128,0,0,0,31,0,0,0,0,15,0,0,0,0,7,0,0,0,0,3,
    0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,192,0,63,255,255,128,1,31,255,255,16,
    1,143,255,254,32,1,199,255,252,96,1,227,255,248,224,1,243,255,241,224,1,248,0,3,224,1,248,0,7,224,1,248,
    0,15,224,1,248,0,15,224,1,248,0,15,224,1,248,0,15,224,3,248,0,15,224,3,248,0,15,224,3,248,0,15,
    192,3,248,0,15,192,3,240,0,15,192,3,224,0,7,192,3,207,255,243,192,1,159,255,241,128,0,63,255,248,0,0,
    63,255,252,0,0,63,255,248,0,1,31,255,241,0,3,143,255,227,128,7,192,0,7,128,7,224,0,31,128,7,240,0,
    31,128,7,240,0,31,128,7,240,0,31,128,7,224,0,63,128,7,224,0,63,128,7,224,0,63,128,7,224,0,63,128,
    15,224,0,63,128,15,224,0,63,128,15,192,0,31,128,15,143,255,143,0,15,31,255,199,0,14,63,255,231,0,12,127,
    255,243,0,8,255,255,249,0,1,255,255,248,0,7,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,192,0,63,255,255,128,1,31,255,
    255,16,1,143,255,254,32,1,199,255,252,96,1,227,255,248,224,1,243,255,241,224,1,248,0,3,224,1,248,0,7,224,
    1,248,0,15,224,1,248,0,15,224,1,248,0,15,224,1,248,0,15,224,3,248,0,15,224,3,248,0,15,224,3,248,
    0,15,192,3,248,0,15,192,3,240,0,15,192,3,224,0,7,192,3,207,255,243,192,1,159,255,241,128,0,63,255,248,
    0,0,63,255,252,0,0,63,255,248,0,0,31,255,241,0,0,15,255,227,128,0,0,0,7,128,0,0,0,31,128,0,
    0,0,31,128,0,0,0,31,128,0,0,0,31,128,0,0,0,63,128,0,0,0,63,128,0,0,0,63,128,0,0,0,
    63,128,0,0,0,63,128,0,0,0,63,128,0,0,0,31,128,0,15,255,143,0,0,31,255,207,0,0,63,255,231,0,
    0,127,255,243,0,0,255,255,249,0,1,255,255,248,0,7,255,255,252,0,
    # Bitmap Raw Data end ---
])

def eve_init_fonts(eve, font_custom):
    global font0
    global font0_offset
    global font_width_in_pixels

    font0_size = len(font0);
    # Legacy font so the width is at offset 136 (little endian)
    font_width_in_pixels = struct.unpack("I", font0[136:140])[0]

    eve.LIB_WriteDataToRAMG(font0, font0_offset);

    eve.LIB_BeginCoProList()
    eve.CMD_DLSTART()
    eve.CLEAR(1,1,1)
    eve.COLOR_RGB(255, 255, 255)
    eve.BEGIN(eve.BEGIN_BITMAPS)
    eve.CMD_SETFONT(font_custom, font0_offset, 0);
    eve.END();
    eve.DISPLAY();
    eve.CMD_SWAP();
    eve.LIB_EndCoProList();
    eve.LIB_AwaitCoProEmpty();
    
    return ((font0_size + font0_offset) + 16) & (~15)
